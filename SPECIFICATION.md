# 견적서 관리 시스템 구현 명세서

## 1. 구현 현황 추적

### 구현 상태 범례
- 🔴 미구현
- 🟡 구현 진행중
- 🟢 구현 완료
- ⭐ 테스트 완료

### 백엔드 구현 현황
| 기능 | 상태 | 구현일자 | 구현내용 | 테스트여부 |
|-----|------|---------|----------|------------|
| 사용자 인증 | ⭐ | 2024-10-31 | JWT 기반 인증 시스템 구현 완료 | 구현 검증 완료 |
| 사용자 권한 관리 | ⭐ | 2024-10-31 | Role-based 권한 관리 시스템 구현 | 구현 검증 완료 |
| 견적서 CRUD | ⭐ | 2024-10-31 | 견적서 CRUD API 구현 | 권한 기반 API 검증 완료 |
| 단가표 관리 | ⭐ | 2024-10-31 | 단가표 CRUD 및 가져오기/내보내기 API 구현 | 권한 기반 API 검증 완료 |
| 회사/제품 관리 | ⭐ | 2024-10-31 | 회사/제품/매체 유형 관리 API 구현 | 권한 기반 API 검증 완료 |
| 파일 생성 (Excel) | ⭐ | 2024-10-31 | Excel 견적서 생성 구현 | 견적서 포맷 검증 완료 |
| 파일 생성 (PDF) | ⭐ | 2024-10-31 | PDF 견적서 생성 구현 | 견적서 포맷 검증 완료 |
| 버전 관리 | 🔴 | - | - | - |
| 동시 접근 제어 | 🔴 | - | - | - |
| 로깅 시스템 | 🔴 | - | - | - |
| 백업 시스템 | 🔴 | - | - | - |

### 프론트엔드 구현 현황
| 기능 | 상태 | 구현일자 | 구현내용 | 테스트여부 |
|-----|------|---------|----------|------------|
| 로그인/인증 UI | 🟡 | 2024-10-29 | 기본 로그인 폼 구현 | 수동 테스트 완료 |
| 견적서 목록 | 🟡 | 2024-10-31 | 기본 목록 UI 구현 완료 (의존성 설치 필요) | 테스트 대기중 |
| 견적서 생성/수정 | 🟡 | 2024-10-31 | 견적서 폼 구현 완료 (테스트 필요) | - |
| 단가표 import | 🟡 | 2024-10-31 | 엑셀 파일 import 컴포넌트 구현 완료 (테스트 필요) | - |
| 단가표 관리 UI | 🟡 | 2024-10-31 | 단가표 CRUD UI 구현 완료 (테스트 필요) | - |
| 회사/제품 관리 UI | 🟡 | 2024-10-31 | 회사/제품 관리 UI 구현 완료 (테스트 필요) | - |
| 권한별 UI 제어 | 🟡 | 2024-10-31 | 권한별 컴포넌트 접근 제어 구현 완료 (테스트 필요) | - |
| 버전 히스토리 UI | 🟡 | 2024-10-31 | 견적서/단가표 버전 관리 UI 구현 중 | - |

### 데이터베이스 구현 현황
| 기능 | 상태 | 구현일자 | 구현내용 | 테스트여부 |
|-----|------|---------|----------|------------|
| 기본 스키마 | ⭐ | 2024-10-29 | 주요 테이블 구조 정의 | 스키마 검증 완료 |
| 마이그레이션 | ⭐ | 2024-10-31 | Initial migration 구현 | 마이그레이션 생성 검증 완료 |
| 백업 시스템 | 🔴 | - | - | - |

## 2. 현재 구현 상태

### 백엔드 (FastAPI)
- 기본 구조 구현됨
  - 사용자 인증/권한 관리 (auth.py)
  - 사용자 관리 (users.py)
  - 견적서 관리 (quotations.py)
  - 단가표 관리 (price_tables.py)
  - 회사/제품 관리 (companies.py)
  - 파일 내보내기 (exports.py)

#### 구현된 기능:
- 기본적인 데이터베이스 모델 설계
- 사용자 인증 시스템 (JWT 기반)
- 기본적인 CRUD 작업

#### 구현 필요 사항:
1. 데이터베이스 마이그레이션 스크립트
2. 견적서 버전 관리 시스템
3. 동시 접근 제어 메커니즘
4. 견적서 export 기능 (Excel/PDF)
5. 단가표 import/export 기능
6. 로깅 시스템
7. 백업/복구 시스템

### 프론트엔드 (React + TypeScript)
- 기본 구조 구현됨
  - 사용자 인증
  - 견적서 목록/폼
  - 단가표 관리
  - 회사/제품 관리

#### 구현된 기능:
- 기본적인 라우팅
- 상태 관리 (Redux)
- 컴포넌트 기본 구조

#### 구현 필요 사항:
1. 견적서 편집 인터페이스
2. 단가표 import 미리보기
3. 권한별 UI 제어
4. 견적서 버전 히스토리 UI
5. 실시간 동시 편집 알림
6. 견적서 템플릿 관리 UI

## 2. 시스템 요구사항

### 2.1 사용자 권한
- Admin: 모든 권한 보유
  - 사용자 계정 관리
  - 회사/제품/매체 관리
  - 모든 견적서 접근/수정
  - 단가표 관리
- Project Manager
  - 견적서 생성/수정
  - 견적서 공유 권한 관리
  - 할당된 회사/제품 접근
- Medical Writer
  - 공유받은 견적서만 접근/수정

### 2.2 데이터 구조
- 견적서
  - 기본 정보
    - DATE
    - QUOTE #
    - VALID UNTIL
    - Customer
    - Project Description
  - 매체별 견적 항목
    - 행위별 단가
    - 수량
    - 할인 정보
- 단가표
  - Name
  - Unit
  - Unit price
  - 비고
  - Description

### 2.3 기술적 요구사항
1. 보안
   - JWT 기반 인증
   - HTTPS 필수
   - 권한 기반 접근 제어

2. 데이터 무결성
   - 트랜잭션 관리
   - 버전 관리
   - 동시 접근 제어

3. 가용성
   - 자동 백업
   - 장애 복구 프로세스
   - 로깅 시스템

4. 성능
   - 페이지네이션
   - 캐싱
   - 대용량 파일 처리 최적화

### 2.3.1 견적서 목록 UI 구현 명세
1. 기본 레이아웃
   - 상단 필터/검색 영역
   - 견적서 목록 테이블
   - 하단 페이지네이션
   
2. 필수 기능
   - 견적서 목록 조회 (페이지네이션)
   - 검색 기능 (견적서 번호, 고객사, 프로젝트명)
   - 필터링 (날짜, 상태, 담당자)
   - 정렬 (날짜, 견적서 번호, 금액)
   - 견적서 상태 표시 (대기중, 승인됨, 거절됨)

3. 목록 표시 항목
   - 견적서 번호 (QUOTE #)
   - 작성일 (DATE)
   - 유효기간 (VALID UNTIL)
   - 고객사 (Customer)
   - 프로젝트명 (Project Description)
   - 총 금액
   - 상태
   - 작성자
   - 액션 버튼 (수정, 삭제, PDF 출력)

4. 권한별 기능 제어
   - Admin: 모든 견적서 접근 가능
   - Project Manager: 본인 및 팀 견적서
   - Medical Writer: 공유받은 견적서만

5. 성능 최적화
   - 서버사이드 페이지네이션
   - 목록 데이터 캐싱
   - 이미지 레이지 로딩
   
6. 사용자 경험
   - 로딩 상태 표시
   - 에러 핸들링
   - 반응형 디자인
   - 키보드 네비게이션

### 2.4 배포 전략
1. 백엔드
   - Docker 컨테이너화
   - AWS ECS 또는 Azure Container Apps 권장
   - 로드 밸런싱 구성

2. 프론트엔드
   - Vercel 또는 Netlify 권장
   - CDN 활용
   - HTTPS 인증서 적용

3. 데이터베이스
   - AWS RDS 또는 Azure Database
   - 자동 백업 구성
   - 읽기 복제본 구성 (필요시)

## 3. 모듈화 전략

### 3.1 백엔드 모듈
1. 인증/권한 모듈
2. 견적서 관리 모듈
3. 단가표 관리 모듈
4. 회사/제품 관리 모듈
5. 파일 처리 모듈
6. 로깅/모니터링 모듈

### 3.2 프론트엔드 모듈
1. 인증/권한 컴포넌트
2. 견적서 관련 컴포넌트
3. 단가표 관리 컴포넌트
4. 회사/제품 관리 컴포넌트
5. 공통 UI 컴포넌트
6. 상태 관리 모듈

## 4. 추가 고려사항

### 4.1 견적서 템플릿
- A4 사이즈 최적화
- 디자인 가이드라인 통합
- 동적 템플릿 수정 기능

### 4.2 데이터 마이그레이션
- 기존 데이터 이전 계획
- 테스트 데이터 생성
- 롤백 절차

### 4.3 모니터링/유지보수
- 에러 추적 시스템
- 성능 모니터링
- 사용자 피드백 수집

### 4.4 확장성
- API 버저닝
- 마이크로서비스 전환 가능성
- 다국어 지원 가능성